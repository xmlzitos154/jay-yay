#!/bin/bash

## This program is made to simplefy the YAY AUR HELPER command
## Ver. 0.3.0


## -- The Actual Code -- ##

LOG_FILE=$HOME/.cache/joylog.txt
touch $LOG_FILE

if [[ -z "$1" ]]; then
    read -p "What you want to do?: " DO
else
    DO="$1"
    PROG="$2"  
fi
if [[ "$DO" == "install" ]]; then
DO="S"
LOGGER="[INSTALLED]"
SR="1"
fi

if [[ "$DO" == "remove" ]]; then
DO="Rsn"
LOGGER="[REMOVED]"
SR="1"
fi

if [[ "$DO" == "refresh" ]]; then
DO="Syy"
LOGGER="[REFRESHED REPOS]"
SR="0"
fi

if [[ "$DO" == "refdate" ]]; then
DO="Syyu"
LOGGER="[REFRESHED REPOS AND UPDATED]"
SR="0"
fi

if [[ "$DO" == "help" ]]; then

    echo -e "HELP:\n"
    echo "$ install    (Sync)"
    echo "$ remove     (Remove)"
    echo "$ refresh    (Refresh)"
    echo "$ update     (Update system)"
    echo "$ refdate    (Refresh and Update system)"
    echo
    echo "$ logs       (Show old Syncs log)"
    echo "$ clear-log  (Clear old Syncs log)"
    echo
    exit 1
fi

if [[ "$DO" == "logs" ]]; then
echo "--- JOY YAY LOGS ---"
cat $LOG_FILE
exit 0
fi

if [[ "$DO" == "exit" ]]; then
exit 0
fi

if [[ "$DO" == "clear-log" ]]; then
rm $LOG_FILE
read -p "Done..."
exit 0
fi



if [[ "$SR" == "1" ]]; then
    clear
    if [[ -z "$PROG" ]]; then
        read -p "What program you want do Modify?: " PROG
    fi
    if yay -$DO $PROG --noconfirm; then
        FINAL_LOG="$LOGGER $PROG"
        echo $FINAL_LOG >> $LOG_FILE
        echo "" >> $LOG_FILE
    else
        echo "[ERROR] Problem with YAY ($(date "+%H:%M - %D"))" >> $LOG_FILE
        echo "ERROR: Command not executed correctly"
    fi
fi

if [[ "$SR" == "0" ]]; then
    if yay -$DO --noconfirm; then
        FINAL_LOG="$LOGGER"
        echo $FINAL_LOG >> $LOG_FILE
        echo "" >> $LOG_FILE
    else
        echo "[ERROR] Problem with YAY ($(date "+%H:%M - %D"))" >> $LOG_FILE
        echo "ERROR: Command not executed correctly"
    fi
fi

## -- END -- ##
